<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarcShop - Accueil</title>
    <link rel="stylesheet" href="styles.css">
    <script defer src="scripts.js"></script>
</head>
<body>
<header>
    <h1>Bienvenue sur MarcShop</h1>
    <p>Livraison gratuite sur toutes les commandes !</p>
    <nav>
         <a href="index.html">Accueil</a>
        <a href="panier.html">Panier</a>
        <a href="suivie.html">Suivi des commandes</a>
        <a href="login.html" id="login-link">Connexion</a>
        <a href="signup.html">Inscription</a>
        <a href="https://wa.me/18093978951?text=Bonjour,%20bienvenue%20sur%20MarcShop,%20nous%20sommes%20ravis%20de%20vous%20servir.%20Veuillez%20donner%20plus%20d'informations%20sur%20vos%20produits,%20et%20svp%20remplir%20ce%20formulaire.%20Merci%20de%20choisir%20MarcShop." target="_blank" class="whatsapp-btn">
            ðŸ“ž WhatsApp
        </a>
    </nav>
</header>
<main>
    <div id="produits-container">
        <!-- Les produits seront chargÃ©s ici dynamiquement -->
    </div>
</main>
<!-- Modale pour afficher l'image agrandie et la description -->
<div id="modal" class="modal">
    <span class="close" onclick="closeModal()">&times;</span>
    <img class="modal-content" id="modalImage">
    <div id="caption"></div>
</div>
<!-- Espace de commentaire -->
<div id="commentaires-container">
    <h3>Commentaires</h3>
    <textarea id="commentaire" placeholder="Ã‰crivez votre commentaire ici..."></textarea>
    <button onclick="envoyerCommentaire()">Envoyer</button>
    <div id="commentaires"></div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const utilisateurConnectÃ© = JSON.parse(localStorage.getItem("utilisateurConnectÃ©"));
        const loginLink = document.getElementById("login-link");

        // Mettre Ã  jour le lien de connexion si l'utilisateur est connectÃ©
        if (utilisateurConnectÃ©) {
            loginLink.textContent = "Mon Compte";
            loginLink.href = "compte.html";
        }

        // Charger les produits depuis le fichier JSON
        fetch('produits.json')
            .then(response => response.json())
            .then(data => {
                const produitsContainer = document.getElementById("produits-container");
                if (produitsContainer) {
                    data.forEach(produit => {
                        const produitDiv = document.createElement("div");
                        produitDiv.classList.add("produit");
                        produitDiv.innerHTML = `
                            <img src="${produit.image}" alt="${produit.nom}" onclick="showModal('${produit.image}', '${produit.description}')">
                            <h3>${produit.nom}</h3>
                            <p>${produit.prix} $</p>
                            <button class="ajouter-panier" onclick='ajouterAuPanier(${JSON.stringify(produit)})'>Ajouter au panier</button>
                        `;
                        produitsContainer.appendChild(produitDiv);
                    });
                }
            })
            .catch(error => console.error('Erreur:', error));
    });

    // Fonction pour afficher la modale
    function showModal(imgSrc, description) {
        const modal = document.getElementById("modal");
        const modalImg = document.getElementById("modalImage");
        const captionText = document.getElementById("caption");

        if (modal && modalImg && captionText) {
            modal.style.display = "block";
            modalImg.src = imgSrc;
            captionText.innerHTML = description;
        }
    }

    // Fonction pour fermer la modale
    function closeModal() {
        const modal = document.getElementById("modal");
        if (modal) {
            modal.style.display = "none";
        }
    }

    // Fonction pour ajouter un produit au panier
    function ajouterAuPanier(produit) {
        let panier = JSON.parse(localStorage.getItem("panier")) || [];
        panier.push(produit);
        localStorage.setItem("panier", JSON.stringify(panier));
        alert("Produit ajoutÃ© au panier !");
    }

    // Fonction pour envoyer un commentaire
    function envoyerCommentaire() {
        const commentaire = document.getElementById("commentaire").value;
        const commentairesContainer = document.getElementById("commentaires");

        if (commentaire.trim() !== "") {
            const commentaireDiv = document.createElement("div");
            commentaireDiv.textContent = commentaire;
            commentairesContainer.appendChild(commentaireDiv);
            document.getElementById("commentaire").value = ""; // Vide le champ de commentaire
        } else {
            alert("Veuillez Ã©crire un commentaire avant de l'envoyer.");
        }
    }

    function initialiserEmailJS() {
        emailjs.init("VOTRE_ID_UTILISATEUR");
    }

    // Initialisation de EmailJS
    initialiserEmailJS();
</script>
</body>
</html>
